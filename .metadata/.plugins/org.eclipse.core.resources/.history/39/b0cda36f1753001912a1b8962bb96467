package onlineBook;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class DbOperations {
	Connection con = null;

	public Connection getConnection() {
		String url = "jdbc:mysql://localhost:3306/student";
		String username = "root";
		String password = "mysql123";
		try {
			con = DriverManager.getConnection(url, username, password);
		} catch (SQLException s) {
			System.out.println(s.getMessage());
		}
		return con;
	}

	public String addBook(Book bk) {
		Connection con = null;
		PreparedStatement pst = null;
		try {
			con = getConnection();
			String sql = "insert into book (bookname,bookid,Author,bookcost,copies) values(?,?,?,?,?)";
			pst = con.prepareStatement(sql);
			pst.setString(1, bk.getBookname());
			pst.setInt(2, bk.getBookid());
			pst.setString(3, bk.getAuthor());
			pst.setInt(4, bk.getBookcost());
			pst.setInt(5, bk.getCopies());
			int isExecuted = pst.executeUpdate();
			if (isExecuted != 0) {
				System.out.println("Book Added successfully");
			} else {
				System.out.println("Adding book failed!!");
			}
		} catch (SQLException e) {
			System.out.println(e.getMessage());
		}
		return bk.getBookname();
	}

}
